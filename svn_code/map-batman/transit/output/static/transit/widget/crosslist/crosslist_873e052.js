define("transit:widget/crosslist/crosslist.js",function(require,exports,module){var url=require("common:widget/url/url.js"),datepicker=require("common:widget/datepicker/datepicker.js"),util=require("common:static/js/util.js"),stat=require("common:widget/stat/stat.js");module.exports={init:function(){var t=this._getStartTime();$("#dateBox span").html(t),this.bindEvent()},bindEvent:function(){$("#dateBox").on("click",$.proxy(this._popupDateBox,this)),$("select").on("change",$.proxy(this._changeStragety,this))},_bindFilterEvent:function(){$("#filter-cancel").on("click",$.proxy(this._hideFilterbox,this)),$("#filter-finish").on("click",$.proxy(this._hideFilterbox,this))},_getStartTime:function(){var t,e=this,a=url.get().query||{},i=a.date,n=new Date,r=n.getTime()+864e5,o=new Date(r),d=e._getDate(n),l=e._getDate(o);return t=i===l||void 0===i?"明天出发":i===d?"今天出发":i.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")},_getDate:function(t){var e=t.getFullYear()+"",a=t.getMonth()+1+"",i=t.getDate()+"",n=e+(1===a.length?"0"+a:a)+(1===i.length?"0"+i:i);return n},_hideFilterbox:function(){$("#filter-box").hide()},_changeStragety:function(t){var e,a=t.target,i=a.value;switch(i){case"价格由低到高":e=7;break;case"价格由高到低":e=8;break;case"出发时间由早到晚":e=5;break;case"出发时间由晚到早":e=6;break;case"全程时间由少到多":e=3}stat.addCookieStat(STAT_CODE.CROSS_CITY_STRAGETY_CLICK),url.update({query:{csy:e,rn:5}},{trigger:!0})},_popupDateBox:function(e){var me=this,tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="filter-box"><div class="handler"><button id="filter-cancel">取消</button><button id="filter-finish">完成</button></div><div id="date-content"></div><div id="strategy-content"></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];tpl=tpl(),0==$("#filter-box").length&&($("body").append(tpl),me._bindFilterEvent());var dateBox=$("#date-content"),planBox=$("#strategy-content"),date=new Date,dateInfo=$("#dateBox span").html(),container=$("#filter-box"),curDate;if("今天出发"===dateInfo)curDate=date;else if("明天出发"===dateInfo)curDate=new Date(date.getTime()+864e5);else{var dateArr=dateInfo.match(/(\d{4})-(\d{2})-(\d{2})/);curDate=new Date(dateArr[1],parseInt(dateArr[2])-1,dateArr[3])}dateBox.datepicker({minDate:new Date(date.getFullYear(),date.getMonth(),date.getDate()),date:curDate,valuecommit:function(t,e,a){stat.addCookieStat(STAT_CODE.CROSS_CITY_DATE_CLICK);var i=a.split("-").join("");url.update({query:{date:i,rn:5}},{trigger:!0})}}),planBox.hide(),dateBox.show(),container.show(),me._simulationFixed()},_simulationFixed:function(){function t(){var t=window.innerHeight+document.body.scrollTop-283;e.css("top",t)}var e=$("#filter-box");util.isIPad()?(e.css({bottom:0,position:"absolute"}),$(document).on("scroll",t),this._hasBindDateBoxEvent||(this._bindDateBoxEvent(),this._hasBindDateBoxEvent=!0)):e.css({bottom:0,position:"fixed"})}}});