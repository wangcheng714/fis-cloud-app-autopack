define("transit:widget/crossdetail/crossdetail.js",function(t,i,n){"use strict";var a=t("common:widget/stat/stat.js"),o=t("common:static/js/util.js");n.exports={init:function(){this.bindEvent()},bindEvent:function(){var t=$(".transit-widget-crossdetail");$(".train-booking").on("click",$.proxy(this._addTrainStat,this)),$(".air-booking").on("click",$.proxy(this._addAirStat,this)),t.find(".incity-plan").on("click",$.proxy(this.onIncityPlanClick,this))},_addTrainStat:function(t){var i=t.target,n=$(i).data("tel");return o.isAndroid()?o.TelBox.showTb(n):window.location.href="tel:"+n,a.addStat(STAT_CODE.CROSS_CITY_TRAIN_ORDER_CLICK),!1},_addAirStat:function(){a.addStat(STAT_CODE.CROSS_CITY_AIR_ORDER_CLICK)},onIncityPlanClick:function(t){var i=$(t.currentTarget);a.addCookieStat(STAT_CODE.CROSS_CITY_INCITY_PLAN_CLICK),window.open(i.data("href"),"_self")}}});
;define("transit:widget/crosslist/crosslist.js",function(require,exports,module){var url=require("common:widget/url/url.js"),datepicker=require("common:widget/datepicker/datepicker.js"),util=require("common:static/js/util.js"),stat=require("common:widget/stat/stat.js");module.exports={init:function(){var t=this._getStartTime();$("#dateBox span").html(t),this.bindEvent()},bindEvent:function(){$("#dateBox").on("click",$.proxy(this._popupDateBox,this)),$("select").on("change",$.proxy(this._changeStragety,this))},_bindFilterEvent:function(){$("#filter-cancel").on("click",$.proxy(this._hideFilterbox,this)),$("#filter-finish").on("click",$.proxy(this._hideFilterbox,this))},_getStartTime:function(){var t,e=this,a=url.get().query||{},i=a.date,n=new Date,r=n.getTime()+864e5,o=new Date(r),d=e._getDate(n),l=e._getDate(o);return t=i===l||void 0===i?"明天出发":i===d?"今天出发":i.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")},_getDate:function(t){var e=t.getFullYear()+"",a=t.getMonth()+1+"",i=t.getDate()+"",n=e+(1===a.length?"0"+a:a)+(1===i.length?"0"+i:i);return n},_hideFilterbox:function(){$("#filter-box").hide()},_changeStragety:function(t){var e,a=t.target,i=a.value;switch(i){case"价格由低到高":e=7;break;case"价格由高到低":e=8;break;case"出发时间由早到晚":e=5;break;case"出发时间由晚到早":e=6;break;case"全程时间由少到多":e=3}stat.addCookieStat(STAT_CODE.CROSS_CITY_STRAGETY_CLICK),url.update({query:{csy:e,rn:5}},{trigger:!0})},_popupDateBox:function(e){var me=this,tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="filter-box"><div class="handler"><button id="filter-cancel">取消</button><button id="filter-finish">完成</button></div><div id="date-content"></div><div id="strategy-content"></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];tpl=tpl(),0==$("#filter-box").length&&($("body").append(tpl),me._bindFilterEvent());var dateBox=$("#date-content"),planBox=$("#strategy-content"),date=new Date,dateInfo=$("#dateBox span").html(),container=$("#filter-box"),curDate;if("今天出发"===dateInfo)curDate=date;else if("明天出发"===dateInfo)curDate=new Date(date.getTime()+864e5);else{var dateArr=dateInfo.match(/(\d{4})-(\d{2})-(\d{2})/);curDate=new Date(dateArr[1],parseInt(dateArr[2])-1,dateArr[3])}dateBox.datepicker({minDate:new Date(date.getFullYear(),date.getMonth(),date.getDate()),date:curDate,valuecommit:function(t,e,a){stat.addCookieStat(STAT_CODE.CROSS_CITY_DATE_CLICK);var i=a.split("-").join("");url.update({query:{date:i,rn:5}},{trigger:!0})}}),planBox.hide(),dateBox.show(),container.show(),me._simulationFixed()},_simulationFixed:function(){function t(){var t=window.innerHeight+document.body.scrollTop-283;e.css("top",t)}var e=$("#filter-box");util.isIPad()?(e.css({bottom:0,position:"absolute"}),$(document).on("scroll",t),this._hasBindDateBoxEvent||(this._bindDateBoxEvent(),this._hasBindDateBoxEvent=!0)):e.css({bottom:0,position:"fixed"})}}});
;define("transit:widget/list/list.js",function(t,e,i){var a=t("common:widget/datescrollpick/datescrollpicker.js"),s=t("common:widget/url/url.js"),o=t("common:widget/broadcaster/broadcaster.js"),n=t("common:widget/popup/popup.js"),r=t("common:widget/stat/stat.js"),c=t("common:widget/geolocation/location.js"),l=t("common:static/js/util.js");i.exports={init:function(t){this.render(t),this.bind(t)},render:function(t){var e=this,i=s.get();e.selectedTool=$("#takesubwayselect"),e.start=$(".start-time .text")[0],e.action=i.action,e.module=i.module,e.pageState=i.pageState,e.query=i.query,e.initDateSelector(t.result),e._initPage(t)},_initPage:function(){var t=this,e=l.ifSupportSubway(c.getCityCode());e||t.selectedTool.attr("disabled","disabled"),"[0,2,4,7,5,8,9,10,11]"==decodeURIComponent(t.query.f)&&($("#takesubwayselect option[value='1']")[0].selected=!0)},bind:function(){var t=this,e=t.start;$(e).text(this.displayDateTimeText),this.pk||(this.pk=new a(e,{onselect:function(e){t._selectStartTime(e.datetime)}})),this.pk.applyTo(e),o.subscribe("sizechange",$.proxy(function(){this.pk&&this.pk.hide()},this)),t.selectedTool.on("change",$.proxy(t._onselectchange,this))},_onselectchange:function(){var t=$("#takesubwayselect").val(),e=this;e.query.f="1"==t?"[0,2,4,7,5,8,9,10,11]":null,1==t&&r.addCookieStat({code:STAT_CODE.BUS_STRATEGY_CLICK,type:4}),s.update({module:e.module,action:e.action,query:e.query,pageState:e.pageState})},initDateSelector:function(t){var e="",i=t.rplt;switch(i){case 1:e="已经为您屏蔽当前停运的方案!";break;case 2:case 3:e="此时没有可用公交方案，已显示全部方案!"}""!=e&&n.open({text:e});var a=new Date;if(t&&t.exptime){var s=t.exptime.split("T"),o=s[0].split("-"),r=s[1].split(":");a.setYear(o[0]),a.setMonth(o[1]-1),a.setDate(o[2]),a.setHours(parseInt(r[0])),a.setMinutes(parseInt(r[1])),a=new Date(a.getTime()+6e4*((10-r[1]%10)%10))}this.startDateTime=a.format("yyyy-MM-dd hh:mm"),this.displayDateTimeText=this.formatDisplayText(this.startDateTime)},formatDisplayText:function(t){var e=new Date,i=e.getMonth()+1,s=t.split(" "),o=s[0].split("-");s[1].split(":");var n=a.getMday(i),r=e.getDate(),c=o[1]+"",l=o[2]+"";if(o[1]=parseInt(0==c.indexOf("0")?c.substring(1):c),o[2]=parseInt(0==l.indexOf("0")?l.substring(1):l),i==o[1]){var p=o[2];return r==p?"今天 "+s[1]+" 出发":1==p-r?"明天 "+s[1]+" 出发":t}return 1==o[1]-i&&r==n&&1==o[2]?"明天 "+s[1]+" 出发":t},_selectStartTime:function(t){var e=this;$(e.start).html(e.formatDisplayText(t)),e.query.version="5",e.query.exptype="dep",e.query.exptime=t,s.update({module:e.module,action:e.action,query:e.query,pageState:e.pageState})}}});