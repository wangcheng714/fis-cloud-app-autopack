!function(e,t,a){"use strict";var o=require("common:widget/popup/popup.js"),i=require("common:widget/cookie/cookie.js"),r=require("common:static/js/util.js"),s={pageControllerMap:{home:require("taxi:widget/home/home.js"),waiting:require("taxi:widget/waiting/waiting.js"),resubmit:require("taxi:widget/resubmit/resubmit.js"),response:require("taxi:widget/response/response.js"),verify:require("taxi:widget/verify/verify.js"),settings:require("taxi:widget/settings/settings.js"),about:require("taxi:widget/about/about.js")},getPageOptions:function(){return r.urlToJSON(i.get("BAIDU_TAXI_PAGE_OPTIONS"))||{}},request:function(e){$.ajax({type:"POST",dataType:"json",url:"/mobile/webapp/taxi/api/"+r.jsonToQuery($.extend({},e.data,{api:2,os:"webapp"})),success:function(t){t&&0===t.errno?e.success&&$.isFunction(e.success)&&e.success(t):e.error&&$.isFunction(e.error)&&e.error(t)},error:function(t){o.open({text:"当前网络无法使用，请稍后重试！",layer:!0}),$.isFunction(e.error)&&t&&t.errno>0&&e.error()},complete:e.complete})},loadPage:function(e,a){var s,n,u,g=this,c=$("#wrapper");e=e||g.getPageState("lastPage")||"home",a&&("object"==typeof a&&(a=r.jsonToQuery(a)),i.set("BAIDU_TAXI_PAGE_OPTIONS",a)),s="taxi-pagelet-"+e,t.asyncLoad({id:s},a,function(){o.close(),$("<div/>").attr({id:s}).appendTo(c.html("")),g.getPageState("lastPage")!==e&&(n=g.getPageState("lastPage"),u=g.pageControllerMap[n],u&&u.destroy&&$.isFunction(u.destroy)&&u.destroy(),g.setPageState("lastPage",e))})},route:function(){var e,t=this;e=i.get("BAIDU_TAXI_ORDER_ID"),e?this.request({data:{qt:"orderstatus",order_id:e},success:function(e){var a=e.info&&e.info.status;switch(a){case-1:t.loadPage("resubmit");break;case 2:t.loadPage("response");break;case 1:t.loadPage("waiting");break;case 3:case-2:case 3:case 4:i.remove("BAIDU_TAXI_PAGE_STATE"),t.loadPage("home");break;default:i.remove("BAIDU_TAXI_PAGE_STATE"),t.loadPage("home")}t.setPageState("status",a),t.setPageState("existTime",e.info.exist_time)},error:function(){i.remove("BAIDU_TAXI_PAGE_STATE"),t.loadPage("home")}}):this.loadPage(this.getPageState("lastPage"))},getPageState:function(e){var t=r.urlToJSON(i.get("BAIDU_TAXI_PAGE_STATE"));return t&&t[e]},setPageState:function(e,t){var a=r.urlToJSON(i.get("BAIDU_TAXI_PAGE_STATE"));a[e]=t,i.set("BAIDU_TAXI_PAGE_STATE",r.jsonToQuery(a))},removePageState:function(e){this.setPageState(e,a)},init:function(){o.open({text:"正在加载...",layer:!0,autoCloseTime:0}),this.route()}};s.init(),e.LoadManager=s}(window,BigPipe);