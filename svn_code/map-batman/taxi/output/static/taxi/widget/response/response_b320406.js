define("taxi:widget/response/response.js",function(e,t,o){"use strict";var i=(e("common:static/js/util.js"),e("common:widget/cookie/cookie.js")),n=e("common:widget/stat/stat.js"),t={create:function(){var e=this.$el=$(".taxi-widget-response"),t=this.$feedbackdialog=e.find(".feedbackdialog"),o=e.find(".btn-on-car"),i=e.find(".btn-not-come"),n=e.find(".btn-agreement"),a=e.find(".btn-end"),r=this.$dialogLayer=$("<div/>").addClass("taxi-widget-response-feedbackdialog-layer").hide().appendTo(document.body);t.appendTo(r),a.on("click",$.proxy(this.onBtnEndClick,this)),o.on("click",$.proxy(this.onBtnOnCarClick,this)),i.on("click",$.proxy(this.onBtnNotComeClick,this)),n.on("click",$.proxy(this.onBtnAgreementClick,this)),this.$responder=e.find(".responder")},showResponder:function(){var e=this.$responder.html(),t=this.options;e=e.replace(/\$\{([a-z_]+)\}/g,function(e,o){return t[o]}),this.$responder.html(e),this.$responder.show()},openDialog:function(){this.$feedbackdialog.show(),this.$dialogLayer.show()},closeDialog:function(){this.$feedbackdialog.hide(),this.$dialogLayer.hide()},onBtnEndClick:function(){this.openDialog()},onBtnOnCarClick:function(){var e=this;LoadManager.request({data:{qt:"ordercomment",order_id:this.orderId,comment_type:4},complete:function(){e.closeDialog(),i.remove("BAIDU_TAXI_ORDER_ID"),LoadManager.loadPage("home"),n.addStat(STAT_CODE.TAXI_ON_CAR)}})},onBtnNotComeClick:function(){var e=this;LoadManager.request({data:{qt:"ordercomment",order_id:this.orderId,comment_type:5},complete:function(){e.closeDialog(),i.remove("BAIDU_TAXI_ORDER_ID"),LoadManager.loadPage("home"),n.addStat(STAT_CODE.TAXI_NOT_COME)}})},onBtnAgreementClick:function(){var e=this;LoadManager.request({data:{qt:"ordercomment",order_id:this.orderId,comment_type:6},complete:function(){e.closeDialog(),i.remove("BAIDU_TAXI_ORDER_ID"),LoadManager.loadPage("home"),n.addStat(STAT_CODE.TAXI_AGREEMENT)}})},resizeFeedbackdialog:function(){this.$feedbackdialog.css({width:"270px",height:"210px",left:(window.innerWidth-270)/2+"px",top:(window.innerHeight-210)/2+"px"})},getTaxiPos:function(){var e,t=this,o=this.$el,i=o.find(".distance .count"),n=o.find(".rest-time .count");e=setInterval(function(){LoadManager.request({data:{qt:"taxipos",order_id:t.orderId},success:function(t){var o=t.info;i.text(o.distance),n.text(o.rest_time),o.is_arrived&&(clearInterval(e),e=-1)},error:function(){}})},5e3),this.interval=e},destroy:function(){clearInterval(this.interval),this.interval=-1},init:function(){var e=this.options=LoadManager.getPageOptions(),t=i.get("BAIDU_TAXI_ORDER_ID");e&&t||LoadManager.loadPage("home"),this.orderId=t,this.create(),this.showResponder(),this.resizeFeedbackdialog(),this.getTaxiPos()}};o.exports=t});