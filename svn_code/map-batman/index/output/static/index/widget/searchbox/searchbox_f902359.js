define("index:widget/searchbox/searchbox.js",function(t,i,o){var e=(t("common:static/js/util.js"),t("common:widget/url/url.js")),n=t("common:widget/broadcaster/broadcaster.js"),s=(t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),a=(t("common:widget/quickdelete/quickdelete.js"),t("common:widget/suggestion/suggestion.js"),t("common:widget/search/poisearch.js")),c=t("common:widget/stat/stat.js"),r=t("common:widget/apphistory/apphistory.js");o.exports={init:function(){this.render(),this.bind()},render:function(){var t=this;window.localStorage&&window.localStorage.input&&(r.isLanding()?localStorage.removeItem("input"):$("#se-input-poi").val(localStorage.input)),this._poiQuick=$.ui.quickdelete({container:".se-input-poi",offset:{x:0,y:2}}),this._poiSug=$.ui.suggestion({container:".se-input-poi",mask:".se-form",source:"http://map.baidu.com/su",listCount:6,posAdapt:!1,isSharing:!0,offset:{x:0,y:52},param:$.param({type:"0",newmap:"1",ie:"utf-8"}),onsubmit:function(){var i=this.getValue();$(".se-input-poi").val(i),i&&t.submit()}})},bind:function(){$(".se-form").on("submit",$.proxy(this.submit,this)),$(".se-btn").on("click",$.proxy(this.submit,this)),$(".se-input-poi").on("blur",function(){$(".se-city").show()}),$(".se-input-poi").on("focus",function(){$(".se-city").hide()}),n.subscribe("geolocation.success",this.updateMyPos,this),$(".index-widget-searchbox [jsaction]").on("click",$.proxy(this.go,this))},go:function(t){var i=$(t.currentTarget);switch(i.attr("jsaction")){case"toNavSearch":var o={qt:"cur",wd:s.getCity()||"全国",from:"maponline",tn:"m01","ie=utf-8":"utf-8"};window.localStorage&&(localStorage.input=$("#se-input-poi").val()),e.update({query:o,pageState:{tab:"line"}},{queryReplace:!0})}return!1},submit:function(t){var i=$(".se-input-poi");if(!this._checkInput(i))return!1;if(t){var o=$(t.currentTarget),e=o.attr("user-data");"se-btn"==e&&this._poiSug&&this._poiSug._localStorage(i.val())}return i.blur(),c.addCookieStat(STAT_CODE.STAT_POI_SEARCH),a.search(i.val()),!1},updateMyPos:function(t){t=t?t:s.getLocation(),t.addr&&t.addr.city&&$(".se-city-wd").text(t.addr.city)},_checkInput:function(t){return t?/\S+/.test(t.val())?!0:(t.focus(),!1):!1}}});