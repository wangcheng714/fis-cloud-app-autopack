define("index:widget/addestop/addestop.js",function(t,e,o){var i=t("common:widget/url/url.js"),n=t("common:static/js/util.js"),s=t("common:widget/cookie/cookie.js"),d=t("common:widget/stat/stat.js");o.exports={init:function(){this.render(),this.bind()},render:function(){var t=this;t.isosres=!1,t.os=n.isAndroid()?"android":n.isIPhone()?"iphone":n.isIPad()?"ipad":"unknown",t.isios7=n.getIosVersion()},bind:function(){var t=this;t._adddestop(),window.addEventListener("orientationchange",function(){if(t.isosres&&!s.get("addestopShow")){var e=$("#se_tabgroup"),o=e.height();e.css("height",o+1);var i=document.documentElement.clientWidth/2-91,n=document.getElementById("adddesktop-con");t.isios7||(90==window.orientation||-90==window.orientation)&&(i-=40),n.setAttribute("style","left:"+i+"px;bottom: 10px;bottom: 10px;"),e.css("height",e.height()-1)}})},_adddestop:function(){var t=this,e=window._APP_HASH,o=e.module,n=e.action,a=i.get().pageState||{},r=navigator.userAgent,c=navigator.appVersion,p=/\s+UC\s+/i.test(r)||/\s+UC\s+/i.test(r)||/UCWeb/i.test(r)||/UCBrowser/i.test(r)||/UCWeb/i.test(c)||/UCBrowser/i.test(c),l="iphone"==t.os&&r.indexOf("Safari")>0,u=document;if(!l||!window.navigator.standalone)if("index"==n&&"index"==o)if("line"!=a.tab&&"map"!=a.vt){if("ipad"!=t.os&&(p||l)&&!s.get("addestopShow")){u.gE=function(t){return document.getElementById(t)};var g=g||function(){};g.prototype={init:function(){var t=this;t.render(),t.bind()},render:function(){var t=this;t.closebtn=u.gE("adddestop_close_con")},bind:function(){var t=this;t.closebtn.addEventListener("click",t.closeAddestop,!1)},closeAddestop:function(){u.gE("adddesktop-con").style.display="none";var t={domain:location.hostname,path:"/",expires:432e4};s.set("addestopShow",!0,t)}};var h=new g;h.init();var m=u.gE("adddesktop-con-tip"),f=u.gE("adddesktop-con"),w=u.gE("adddesktop-con-star");p&&function(){f.setAttribute("style","top: 10px;"),w.className="ucaddbg adddesktop-con-star"}(),l&&function(){t.isosres=!0,m.setAttribute("style","-webkit-transform: rotate(180deg);left: 82px;top: 75px;");var e=document.documentElement.clientWidth/2-91;f.setAttribute("style","left:"+e+"px;bottom: 10px;"),w.className=t.isios7?"ios7addbg adddesktop-con-star":"iphoneaddbg adddesktop-con-star",u.gE("addestop").innerHTML='再"添加至主屏幕"'}(),d.addStat(STAT_CODE.STAT_ADDDESTOP_SHOW),f.style.display=""}}else $("#adddesktop-con").hide();else $("#adddesktop-con").hide()}}});
;define("index:widget/allcity/allcity.js",function(t,i,e){var n=t("common:widget/setcity/setcity.js");"http://"+location.host+"/mobile/webapp/index/index",e.exports.init=function(){c()};var c=function(){var t=$(".index-widget-allcity");t.on("click",".select-letter span",a),t.on("click",".city-item",o)},a=function(t){var i=$(t.target),e=i.data("href");window.location.replace(e)},o=function(t){var i=$(t.target),e=$.trim(i.data("city")),c=i.data("cityid"),a=i.data("cityeng");n.setAndRedirect(e,c,a)}});
;define("index:widget/helper/helper.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),stat=require("common:widget/stat/stat.js"),searchData=require("common:static/js/searchdata.js"),broadcaster=require("common:widget/broadcaster/broadcaster.js"),locator=require("common:widget/geolocation/location.js");module.exports={cates:{cater:{wd:"美食",id:"cater",count:3,data:void 0},hotel:{wd:"快捷酒店",id:"hotel",count:2,data:void 0},bank:{wd:"银行",id:"bank",data:[{name:"工商银行",key:"icbc"},{name:"农业银行",key:"abc"},{name:"建设银行",key:"cbc"},{name:"中国银行",key:"bc"},{name:"ATM",key:"atm"}]}},thumbConfig:{host:"http://map.baidu.com/maps/services/thumbnails",imgWidth:180,imgHeight:135,oneStarW:15},getData:function(e,t,a){if(1==this.getCityCode())return this.cates[e].data=[],t&&t([]),void 0;a=a||{},this.cates[e].data=void 0,a.page&&"hao123"==a.page&&(this.cates.cater.count=6,this.cates.hotel.count=3);var r=this,o=this.cates[e].wd,n=this.getHash({query:{wd:o}}).query;searchData.fetch(util.jsonToQuery(n),function(a){var n=[];a&&a.content&&(n=r._formatData(o,a.content)),r.cates[e].data=n,t&&t(n)},function(){t&&t([])})},getHash:function(e){var t=e.module||"search",a=e.action||"search",r={qt:"s",wd:"",c:this.getCityCode()},o={};e.query?r=$.extend(r,e.query):(r.wd=e.wd||e.word||e.name,r.searchFlag="sort");var n=url.get(),i=n.query,c=n.pageState||{},s=c.from||"",l=decodeURIComponent(c.center_name||locator.getCity());switch("place"==t&&"takeout"==a&&(o.search="takeout",l=locator.hasExactPoi()?locator.isUserInput()?locator.getAddress():"我的位置":locator.getCity()),s){case"searchnearby":r.center_rank=1,r.nb_x=i.nb_x||c.nb_x,r.nb_y=i.nb_y||c.nb_y,o.from="searchnearby",o.type="searchnearby","place"==t&&"takeout"==a&&(l=decodeURIComponent(c.center_name));break;case"business":r.wd=c.bd+"     "+r.wd,"place"==t&&"takeout"==a&&locator.hasExactPoi()&&(r.center_rank=1,r.nb_x=locator.getPointX(),r.nb_y=locator.getPointY());break;default:locator.hasExactPoi()&&(l=locator.isUserInput()?locator.getAddress():"我的位置",r.center_rank=1,r.nb_x=locator.getPointX(),r.nb_y=locator.getPointY())}return o.center_name=l,"今夜特价"===r.wd&&(r.pl_tonight_sale_flag_section=1,r.pl_data_type="hotel"),{module:t,action:a,query:r,pageState:o}},ready:function(){this.cates.cater.data&&this.cates.hotel.data&&broadcaster.broadcast("nearpush.dataready")},go:function(evt,key){var target=$(evt.currentTarget);switch(target.attr("jsaction")){case key+"-detail":eval("var data = "+target.attr("userdata"));var uid=data.uid;stat.addCookieStat(STAT_CODE.STAT_NEARPUSH_DETAIL_CLICK,{id:data.id}),url.update({module:"place",action:"detail",query:{qt:"inf",uid:uid,c:this.getCityCode()}},{trigger:!0,queryReplace:!0});break;case key+"-all":eval("var data = "+target.attr("userdata"));var word=data.wd||this.cates[key].wd,hash=this.getHash({module:"search",action:"search",query:{wd:word}});stat.addCookieStat(STAT_CODE.STAT_NEARPUSH_ALL_CLICK,{id:data.id}),url.update({module:hash.module,action:hash.action,query:hash.query,pageState:hash.pageState},{trigger:!0,queryReplace:!0,pageStateReplace:!0})}return!1},getCityCode:function(){var e=url.get(),t=(e.query,e.pageState||{});return t.code&&1!=t.code?t.code:locator.getCityCode()||1},_formatData:function(e,t){var a=this;switch(e){case"美食":return a._formatDataCY(t);case"快捷酒店":return a._formatDataHotel(t)}},_formatDataCY:function(e){for(var t=this,a=this.cates.cater.count,r=[],o=[],n=0,i=e.length;i>n;n++){var c={};c.name=e[n].name,c.uid=e[n].uid;var s=void 0;if(void 0!=e[n].ext&&void 0!=e[n].ext.detail_info&&(s=!0,placeInfo=e[n].ext.detail_info),""!=placeInfo.image&&s){if(c.image=t._getImgSrc(placeInfo.image)||"",""!=placeInfo.groupon&&null!=placeInfo.groupon?c.otherflag='<em class="icon groupon-icon"></em>':""!=placeInfo.premium2&&0!=placeInfo.premium2&&null!=placeInfo.premium2&&(c.otherflag='<em class="icon sale-icon"></em>'),c.star=t._getStar(placeInfo.overall_rating)||"",c.comment=placeInfo.comment_num||"",r.push(c),r.length===a)return r}else o.push(c)}return r=r.concat(o.slice(0,a-r.length))},_formatDataHotel:function(e){for(var t=this,a=this.cates.hotel.count,r=[],o=[],n=0,i=e.length;i>n;n++){var c={};c.name=e[n].name,c.uid=e[n].uid,c.addr=e[n].addr;var s=void 0;if(void 0!=e[n].ext&&void 0!=e[n].ext.detail_info&&(s=!0,placeInfo=e[n].ext.detail_info),c.price=placeInfo.price||"",""!=e[n].image&&placeInfo&&""!=e[n].tel){if(c.image=t._getImgSrc(placeInfo.image)||"",c.star=t._getStar(placeInfo.overall_rating)||"",c.tel=t._getTel(e[n].tel)||{},placeInfo.uid=e[n].uid,c.order=t._getOrder(placeInfo),r.push(c),r.length===a)return r;o.push(c)}}return r=r.concat(o.slice(0,a-r.length))},visible:function(e,t,a){var r=$(e)[0],o=function(){var e=r.getBoundingClientRect().top,o=window.innerHeight;o>=e&&t&&(a?t.call(a):t())};o(),$(window).on("scroll",o)},_getTel:function(e){var t,a;return void 0==e||""==e?{}:(t=e.indexOf(",")>-1?e.split(","):e.split(";"),t=t[0].replace(/\(/gi,"").replace(/\)/gi,"-"),a=util.isAndroid()?'href="javascript:void(0);" data-tel="'+t+'"':'href="tel:'+t+'"',{url:a,num:t})},_getOrder:function(e){var t=e.hotel_ori_info,a=e.ota_url;if(""==t||0==t.length)return!1;for(var r=0,o=t.length,n=t[r];o>r;r++)if("qunar"==n.src&&"可预定酒店"==n.hotel_flag)for(var i=0,c=a.length,s=a[i];c>i;i++)if("qunar"==s.src)return!0},_getStar:function(e){if(e){var t=parseInt(10*e)/10*this.thumbConfig.oneStarW,a='<span class="star-box">                            <span class ="star-scroe" style = "width:#rate#px"></span>                    </span>'.replace("#rate#",t);return a}},_getImgSrc:function(e){if("string"!=typeof e||""==e)return F.uri("/static/img/no_img.png");var t=this.thumbConfig;e.indexOf("&nbsp;&nbsp;&nbsp;")>-1&&(e=$.trim(e.split("&nbsp;&nbsp;&nbsp;")[0])),e=e.replace("(","%28"),e=e.replace(")","%29");var a=t.host+"?width="+t.imgWidth+"&height="+t.imgHeight+"&src="+encodeURIComponent(e);return a}}});
;define("index:widget/bizarea/bizarea.js",function(require,exports,module){var util=require("common:static/js/util.js"),searchData=require("common:static/js/searchdata.js"),broadcaster=require("common:widget/broadcaster/broadcaster.js"),locator=require("common:widget/geolocation/location.js"),helper=require("index:widget/helper/helper.js");module.exports={hasGetData:!1,curRenderCity:"",init:function(e){this.wrap=$(".index-widget-bizarea"),e?(this.curRenderCity=locator.getCityCode(),this.wrap.show()):1!=locator.getCityCode()&&this._render(),this._bindGeoEvent()},_render:function(){helper.visible(this.wrap,function(){this.render()},this)},_bindGeoEvent:function(){broadcaster.subscribe("geolocation.success",this.render,this)},render:function(){if(!this.hasGetData||this.curRenderCity!=locator.getCityCode()&&1!=locator.getCityCode()){this.hasGetData=!0,this.curRenderCity=locator.getCityCode();var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.area&&data.area.length>0){_template_fun_array.push('    <h2>热门商区</h2>    <ul class="clearfix biz-list">            ');for(var i=0,l=data.area.length;l>i;i++){var item=data.area[i];_template_fun_array.push('                <li>                    <a href="/mobile/webapp/index/casuallook/foo=bar/from=business&bd=',"undefined"==typeof item?"":item,"&code=","undefined"==typeof data.code?"":data.code,'" jsaction="jump" user-data="item">',"undefined"==typeof item?"":item,"</a>                </li>            ")}_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],_this=this,host="/mobile/webapp/index/index/?",param={async:"1",fn:"gethotarea",mmaptype:"simple",cityname:locator.getCity()},requestUrl=host+util.jsonToUrl(param);$.ajax({url:requestUrl,dataType:"jsonp",success:function(e){try{var a=e;a&&a.data&&a.data.area?(_this.wrap.show(),_this.wrap.html(tpl({data:a.data}))):_this.error()}catch(t){_this.error()}},error:function(){_this.error()}})}},error:function(){this.wrap.hide()}}});
;define("index:widget/businesslist/businesslist.js",function(require,exports,module){var url=require("common:widget/url/url.js"),util=require("common:static/js/util.js"),searchData=require("common:static/js/searchdata.js"),_dataCache,_areaList={},cityData,BUSINESS_SPLIT="     ",dataPath="/mobile/?&from=maponline&tn=m01&ie=utf-8&data_version=11252019",saveData=function(e){e&&(addAreaItem(e.area_code,e),2==e.area_type&&(cityData=e),e.sub&&$.each(e.sub,function(e,a){addAreaItem(a.area_code,a)}))},addAreaItem=function(e,a){a&&e&&(_areaList[e]=a)},getAreaItem=function(e){return _areaList[e]},bind=function(){var e=$(".index-widget-bussinesslist");e.on("click",".top-title",toggleList),e.on("click","[jsaction]",eventHandler)},completeSelete=function(e){if(e){var a,t=getAreaItem(e),i=url.get(),s=(i.query||{},i.pageState||{}),n=util.urlToJSON(s.refer_query)||{},l=util.urlToJSON(s.refer_pagestate)||{},r={},o={},d=n.wd;r=$.extend({},r,l,{dist_name:t.area_name,keep_stay:1}),d&&d.indexOf(BUSINESS_SPLIT)>-1&&(d=d.split(BUSINESS_SPLIT)[1]),10==t.area_type?(d=t.area_name+BUSINESS_SPLIT+d,a=cityData.area_code):a=t.area_code,o=$.extend(o,n,{c:a,wd:d,pn:0}),delete o.nb_x,delete o.nb_y,delete o.center_rank,url.update({module:"place",action:"list",query:o,pageState:r})}},listSub=function(e,a){if(e&&a){a.data("loaded");var t="/?qt=sub_area_list&level=1&business_flag=1",i=a.next();1==a.data("loaded")?i.hasClass("hide")?(i.data("visible","1"),hideOther(),scrollToEle(a)):hideOther():(t+="&areacode="+e,searchData.fetch(t,function(e){var t=e.content;hideOther(),t&&(saveData(t),appendSubList(t,a))},function(){}))}},scrollToEle=function(e){if(e){var a=e.offset().top;window.scrollTo(0,a)}},hideOther=function(){$(".index-widget-bussinesslist .sub_list .sub_list").not("hide").each(function(e,a){1==$(a).data("visible")?$(a).removeClass("hide"):$(a).addClass("hide"),$(a).data("visible","0")})},appendSubList=function(data,ele){var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<li class="sub_list"><ul class="sub_wrapper"><li data-areacode = "',"undefined"==typeof area_code?"":area_code,'" jsaction="complete"><h4>全区</h4><span class="rl_opt"><em class="rl_opt_btn rl_opt_close"></em></span>               </li>');for(var i=0,l=sub.length;l>i;i++)_template_fun_array.push('<li data-areacode = "',"undefined"==typeof sub[i].area_code?"":sub[i].area_code,'" jsaction="complete"><h4>',"undefined"==typeof sub[i].area_name?"":sub[i].area_name,'</h4><span class="rl_opt"><em class="rl_opt_btn rl_opt_close"></em></span>               </li>');_template_fun_array.push("</ul></li>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],html=tpl(data);$(html).insertAfter(ele),ele.data("loaded","1"),ele.data("visible","1"),scrollToEle(ele)},switchToList=function(e){var a,t,i,s,n=this;a=n.get("pagestate"),t=util.getReqParam(a.refer_query)||{},s=util.getReqParam(a.refer_pagestate)||{},s=$.extend(s,{dist_name:e.isBusiness?"":e.name,keep_stay:1});var l=t.wd.split(mapConst.BUSINESS_SPLIT);l=l[1]?l[1]:t.wd,i={wd:e.isBusiness?e.name+"     "+l:l,c:e.isBusiness?e.cityCode:e.subCode,pn:0},$.extend(t,i),app.updateHash({module:"place",action:"list",query:t,pageState:s},{trigger:!0,queryReplace:!0,pageStateReplace:!0})},toggleList=function(){var e=$(this);e.next().toggleClass("hide")},eventHandler=function(){var e=$(this),a=e.data("areacode"),t=e.attr("jsaction"),i={complete:completeSelete,listsub:listSub},s=i[t];$.isFunction(s)&&s(a,e)};module.exports.init=function(e){saveData(e),bind()}});
;define("index:widget/bussinesslist/bussinesslist.js",function(){});
;define("index:widget/cateinfo/cateinfo.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),helper=require("index:widget/helper/helper.js"),stat=require("common:widget/stat/stat.js");module.exports={init:function(){this.bind()},bind:function(){var e=this;$(".index-widget-cateinfo [jsaction]").on("click",function(t){var a=$(t.currentTarget);e.search(a.attr("userdata"))})},search:function(userdata){eval("var hash = "+userdata),stat.addCookieStat(STAT_CODE.STAT_CATEINFO_CLICK,{cate:hash.cate,name:hash.wd}),url.update(helper.getHash(hash))}}});
;define("index:widget/curloc/curloc.js",function(c,o,t){var e=c("common:widget/broadcaster/broadcaster.js"),i=c("common:widget/geolocation/location.js");t.exports.init=function(){e.subscribe("geolocation.success",n,this)};var n=function(){var c=$(".widget-index-curloc .current-city"),o=i.getAddress();c.html(o)}});
;define("index:widget/error/error.js",function(o,e,t){var n="_lastPageUrl",i=function(){$(".back-last-page").on("click",function(){r()})},r=function(){var o=window.localStorage.getItem(n);"string"==typeof o?(window.localStorage.removeItem(n),window.location.replace(o)):history.back()};t.exports.init=i});
;define("index:widget/helper/revert.js",function(e,n,r){r.exports={init:function(){window.eventRecorder&&(eventRecorder.stop(),eventRecorder.play(),window.eventRecorder=null,delete window.eventRecorder)}}});
;define("index:widget/hotcity/hotcity.js",function(t,i,e){var c=t("common:widget/setcity/setcity.js");e.exports.init=function(){n()};var n=function(){var t=$(".index-widget-hotcity");t.on("click",".city-item",d)},d=function(t){var i=$(t.target),e=i.text(),n=i.data("cityid"),d=i.data("cityeng");c.setAndRedirect(e,n,d)}});
;define("index:widget/locsearch/locsearch.js",function(e,t,o){var a=$(".index-widget-locsearch"),r="输入城市或者其他位置",n=e("common:widget/geolocation/location.js"),i=e("common:widget/url/url.js"),c="_refer_query",l="_refer_pagestate";o.exports.init=function(){u(),s()};var u=function(){var e=$("#search-input"),t=a.find("#search-button"),o=a.find("form");e.on("focus",$.proxy(d,this)),e.on("blur",f),e.on("foucs",d),t.on("click",p),o.on("submit",p)},s=function(){window.localStorage.removeItem(c),window.localStorage.removeItem(l)},d=function(e){var t=$(e.target);t.val()===r&&(t.val(""),t.removeClass("ipt"))},f=function(e){var t=$(e.target);""===$.trim(t.val())&&(t.val(r),t.addClass("ipt"))},g=function(e){var t={qt:"s",wd:$.trim(e),c:n.getCityCode()};return t},p=function(e){var t=$("#search-input"),o=t.val(),a=g(o),r=i.get().pageState||{};window.localStorage.setItem(c,r.refer_query),window.localStorage.setItem(l,r.refer_pagestate),i.update({module:"place",action:"selectpoint",query:a,pageState:{}},{queryReplace:!0,pageStateReplace:!0}),e.preventDefault()}});
;define("index:widget/morecategory/morecategory.js",function(e,t,r){MY_GEO="我的位置";var n=e("common:widget/geolocation/location.js"),a=e("common:widget/url/url.js").get();r.exports={init:function(){this.render(),this.bind()},render:function(){this.parentele=$(".categoryparent"),this.morecategory=$("#more-category"),this.childele=$(".categorychild h4")},bind:function(){var e=this;e.parentele.on("click",$.proxy(e._handleClickEvent,this)),e._setCenterName(),e.childele.on("click",$.proxy(e._redirect,this))},_redirect:function(e){var t=this.getUrl($(e.target).text()),r="/mobile/webapp/"+t.action+"/"+t.module+"/"+$.param(t.query)+"/"+$.param(t.pageState);location.href=r},_handleClickEvent:function(e){var t=this;e.target,t.toggleClickedLiIcon(e)},_setCenterName:function(){var e=a.pageState,t=a.query,r=(t.wd||"").split("     ");return"更多"===r[1]?(this.centerName=r[0],this.centerName):e.center_name?decodeURIComponent(e.center_name):n.hasExactPoi()?MY_GEO:n.getCity()},toggleClickedLiIcon:function(e){var t=this,r=$(e.target).parent();childli=r.next(".rl_sub_list"),"none"==childli.css("display")?(r.find("em").removeClass("rl_opt_close"),r.find("em").addClass("rl_opt_open"),$(".rl_sub_list").hide(),childli.show()):(r.find("em").removeClass("rl_opt_open"),r.find("em").addClass("rl_opt_close"),childli.hide()),t.currentLi=t.getCurrentLi(e.target),t._scrollToCurrentCategory()},_scrollToCurrentCategory:function(){var e=this,t=$(e.currentLi).offset();window.scroll(0,t.top)},getCurrentLi:function(e){var t=e;if("LI"!==t.nodeName)for(;null!=e.parentNode;){if("LI"===e.parentNode.nodeName){t=e.parentNode;break}e=e.parentNode}return t},getUrl:function(e){var t={module:"search",action:"search",query:{qt:"s",wd:this.centerName?e+" "+this.centerName:e,searchFlag:"more_cate",c:n.getCityCode()||1},pageState:{}};return t=this.setCenterPoi(t),this.centerName&&(delete t.query.nb_x,delete t.query.nb_y,delete t.query.center_rank,delete t.pageState.center_name),t},setCenterPoi:function(e){var t=e||{};t.query=t.query||{},t.pageState=t.pageState||{};var r=a.pageState,i=a.query;return r&&"searchnearby"==r.type||r&&"searchnearby"==r.from?(t.query.center_rank=1,t.query.nb_x=i.nb_x,t.query.nb_y=i.nb_y,t.pageState.center_name=r.center_name,t):(n.hasExactPoi()&&(t.query.center_rank=1,t.query.nb_x=n.getPointX(),t.query.nb_y=n.getPointY(),t.pageState.center_name=n.isUserInput()?n.getAddress():"我的位置"),t)}}});
;define("index:widget/navebox/navebox.js",function(){});
;define("index:widget/navethumbnail/navethumbnail.js",function(t,e,i){var n=t("common:widget/broadcaster/broadcaster.js"),a=t("common:static/js/util.js"),o=(t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),s=t("common:static/js/searchdata.js"),r=t("common:widget/stat/stat.js"),c={type:"0,2",level:16,height:101,width:window.innerWidth-22,url:null,host:"http://snap.map.baidu.com/?qt=snap&data="},u=window._CURRENT_CITY,h=u.name;a.showLoading($("#poipic-area")),i.exports={init:function(){this.render(),this.bind()},render:function(){this.thumbImage=$("#mapimg"),this.errorCnt=$(".error-cnt"),this.thumbImageA=$("#right-a"),this.subwayBtn=$("#subwayBtn"),this.cityNameCnt=$("#cityNameCnt"),this.nearbus=$("#nb-bus"),this.nearbusspan=$("#busspan"),this.nearsubway=$("#nb-subway"),this.nearsubwayspan=$("#stationspan"),this.imgcon=$("#route-pic")},bind:function(){var t=this;n.subscribe("geolocation.mylocsuc",function(){t.setLocation()},this),n.subscribe("geolocation.fail",function(){t.thumbImageA.hide(),t.errorCnt.show()},this),n.subscribe("sizechange",function(){t._appReSize()},this),t._trafficsubway()},_trafficsubway:function(){var t=this;if("全国"!=h){t.imgcon.show(),t._setThumbUrl();var e=a.ifSupportSubway(o.getCityCode());if(e){var i=e.split(",");t.subwayBtn.attr("href","/mobile/webapp/subway/show/city="+i[0]+"/ref=index"),t.cityNameCnt.html(i[1]+"市地铁线路图"),t.subwayBtn.show(),r.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAYBTN_DISPLAY)}else t.subwayBtn.hide()}},_appReSize:function(){var t=this;a.isAndroid()?setTimeout(function(){c.width=window.innerWidth-22},800):c.width=window.innerWidth-22,t._setThumbUrl()},setLocation:function(){var t=this;o.getMyCityCode()==u.code&&t._getNearbyData()},_setThumbUrl:function(){var t=this,e=t._getThumbUrl();t.thumbImage.attr("src",e),a.hideLoading($("#poipic-area"))},_getThumbUrl:function(){c.level=0==c.type?"全国"==o.getCity()?3:o.hasExactPoi()?16:10:10;var t;u?(JSONdata=u.geo,cityPoint=a.geoToPoint(JSONdata),t={x:0,y:0},t.x=cityPoint.lng,t.y=cityPoint.lat):t=o.getCenterPoi();var e={retype:1,src:"webapp",level:c.level,center:t.x+" "+t.y,height:101,width:c.width,coordtype:"M",pictype:c.type};return c.host+JSON.stringify(e)},_getNearbyData:function(){var t=this,e=$.param(t._getQueryByWd("公交站").query),i=$.param(t._getQueryByWd("地铁站").query);s.fetch(e,$.proxy(t._cbGetBusStation,this)),s.fetch(i,$.proxy(t._cbGetSubwayStation,this))},_getQueryByWd:function(t){var e={qt:"s",wd:t,c:o.getMyCityCode()},i={};return e.center_rank=1,e.nb_x=o.getMyPointX(),e.nb_y=o.getMyPointY(),{query:e,pageState:i}},_cbGetBusStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){var i=t.content[0]||"";e.nearbusspan.text(i.name+"-公交站"),e.nearbusspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+i.uid+"&c="+o.getMyCityCode()+"/tab=line"),e.nearbus.show(),r.addStat(STAT_CODE.STAT_LINEINDEX_BUS_DISPLAY)}},_cbGetSubwayStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){for(var i=void 0,n=0,a=t.content.length;a>n;n++){var s=t.content[n],c=3==s.poiType,u=s.blinfo&&0!=s.blinfo.length;if(c&&u){i=t.content[n];break}}if(void 0!=i){var h=i||"",b=h.name+"-地铁站";e.nearsubwayspan.text(b),e.nearsubwayspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+h.uid+"&c="+o.getMyCityCode()+"/tab=line"),e.nearsubway.show(),r.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAY_DISPLAY)}}}}});
;define("index:widget/nbserachbox/nbserachbox.js",function(e,t,r){MY_GEO="我的位置";var n=e("common:widget/geolocation/location.js"),a=e("common:widget/url/url.js").get(),i=e("common:widget/stat/stat.js");r.exports={init:function(){this.render(),this.bind()},render:function(){this.searchmorenearby=$("#index-widget-nbserachbox"),this.searchInput=$("#search-input"),this.DEFAULT_VALUE="输入其他分类",this.searchBtn=$("#search-button"),this.searcForm=$("#search-form")},bind:function(){var e=this;e._renderCenterName(),e.searchInput.on("focus",$.proxy(e._clearInput,this)),e.searchInput.on("blur",$.proxy(e._resetInput,this)),e.searcForm.on("submit",$.proxy(e._searchPoint,this)),e.searchBtn.on("click",$.proxy(e._searchPoint,this))},_renderCenterName:function(){var e=this._getCenterName();me=this,me.searchmorenearby.prepend('<p id="search-more-nearby">在 <span class="center-name">'+e+"</span> 附近找</p>")},_getCenterName:function(){var e=a.pageState,t=a.query,r=(t.wd||"").split("     ");return"更多"===r[1]?(this.centerName=r[0],this.centerName):e.center_name?e.center_name:n.hasExactPoi()?MY_GEO:n.getCity()},_clearInput:function(e){var t=this,r=$(e.target);r.val()===t.DEFAULT_VALUE&&(r.val(""),r.removeClass("ipt-default"))},_resetInput:function(e){var t=this,r=$(e.target),n=r.val();""===$.trim(n)&&(r.val(t.DEFAULT_VALUE),r.addClass("ipt-default"))},_searchPoint:function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault();var t=this,r=$("#search-input"),n=r.val();return r.get(0).blur(),t._checkValueValid(n)?(t.search($.trim(n)),!1):void 0},_checkValueValid:function(e){return""!==$.trim(e)&&$.trim(e)!==this.DEFAULT_VALUE?!0:!1},search:function(e){"more"==a.action&&i.addStat(STAT_CODE.STAT_MORE_CATEGORY_SEARCH_INPUT);var t=this,r=t._getDirParam($.trim(e));location.href="/mobile/webapp/search/search/"+$.param(r)},_getDirParam:function(e,t){if(e&&"string"==typeof e){t=t||{};var r={qt:"s",wd:this.centerName?e+" "+this.centerName:e,c:n.getCityCode()||1,searchFlag:t.from||""},i=a.pageState;return i.nb_x&&i.nb_x?(r.nb_x=i.nb_x,r.nb_y=i.nb_y,r.center_rank=1,r.center_name=i.center_name):n.hasExactPoi()&&(r.nb_x=n.getPointX(),r.nb_y=n.getPointY(),r.center_rank=1),r.searchFlag="more_cate",r}}}});
;define("index:widget/nearby/nearby.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),helper=require("index:widget/helper/helper.js"),stat=require("common:widget/stat/stat.js"),locator=require("common:widget/geolocation/location.js");module.exports={init:function(t){this.bind(),this.page=t},bind:function(){var t=this;$(".index-widget-nearby [jsaction]").on("click",function(e){var o=$(e.currentTarget);o.find(".ui3-taxi").length>0?location.href="http://taxi.map.baidu.com":t.search(o)})},search:function(target){if(eval("var hash = "+target.attr("userdata")),stat.addCookieStat(STAT_CODE.STAT_NEARBY_CLICK,{id:hash.id}),"团购"==hash.wd)setTimeout(function(){var t;try{if(locator.hasExactPoi()){var e=locator.getCenterPoi();t="http://mtuan.baidu.com/t/locat?from=map_webapp&x="+e.x+"&y="+e.y+"&to_url="+encodeURIComponent(location.href)}else t="http://mtuan.baidu.com/t/locat?from=map_webapp&to_url="+encodeURIComponent(location.href)}catch(o){t="http://mtuan.baidu.com/t/locat?from=map_webapp&to_url="+encodeURIComponent(location.href)}window.location=t},500);else if("地铁图"==hash.wd){var supportCityInfo=util.ifSupportSubway(locator.getCityCode());if(supportCityInfo){var sarr=supportCityInfo.split(",");target.attr("href","/mobile/webapp/subway/show/city="+sarr[0]+"/ref=index")}else target.attr("href","/mobile/webapp/index/setsubwaycity/force=simple")}else"全景"==hash.wd?target.attr("href","/mobile/webapp/index/sventry/force=simple"):url.update(helper.getHash(hash))}}});
;define("index:widget/nearpush/bank.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),searchData=require("common:static/js/searchdata.js"),broadcaster=require("common:widget/broadcaster/broadcaster.js"),locator=require("common:widget/geolocation/location.js"),helper=require("index:widget/helper/helper.js"),id="bank",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <button jsaction="bank-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof wd?"":wd,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">查看全部</button>        <h2>银行</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;l>i;i++)_template_fun_array.push('            <li jsaction="bank-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof data[i].name?"":data[i].name,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <span class="icon ',"undefined"==typeof data[i].key?"":data[i].key,'"></span>                <p>',"undefined"==typeof data[i].name?"":data[i].name,"</p>            </li>        ");_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={init:function(e){this.pagename=e,this.render(),this.bind()},render:function(){$(".index-widget-bank").html(tpl(helper.cates[id]))},bind:function(){$(".index-widget-bank [jsaction]").on("click",this._go)},_go:function(e){helper.go(e,"bank")}}});
;define("index:widget/nearpush/cater.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),stat=require("common:widget/stat/stat.js"),searchData=require("common:static/js/searchdata.js"),broadcaster=require("common:widget/broadcaster/broadcaster.js"),locator=require("common:widget/geolocation/location.js"),geolocator=require("common:widget/geolocation/geolocation.js"),helper=require("index:widget/helper/helper.js"),id="cater",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <a href="javascript:void(0);" jsaction="cater-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof word?"":word,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">            查看全部        </a>        <h2>美食</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;3>i;i++)_template_fun_array.push('            <li jsaction="cater-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof data[i].uid?"":data[i].uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <a class="a-img" href="javascript:void(0);">                    <img width="89" height="66" src="',"undefined"==typeof data[i].image?"":data[i].image,'">                    ',"undefined"==typeof data[i].otherflag?"":data[i].otherflag,'                </a>                <dl>                    <dt class="name">',"undefined"==typeof data[i].name?"":data[i].name,'</dt>                    <dd class="rate">',"undefined"==typeof data[i].star?"":data[i].star,'</dd>                    <dd class="cmt">                        <span class="count">',"undefined"==typeof data[i].comment?"":data[i].comment,'</span>                        <span class="tail">条评论</span>                    </dd>                </dl>            </li>        ');if(_template_fun_array.push("    </ul>    "),"hao123"==page){_template_fun_array.push('        <ul class="list">            ');for(var i=3,l=data.length;6>i;i++)_template_fun_array.push('                <li jsaction="cater-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof data[i].uid?"":data[i].uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                    <a class="a-img" href="javascript:void(0);">                        <img width="89" height="66" src="',"undefined"==typeof data[i].image?"":data[i].image,'">                        ',"undefined"==typeof data[i].otherflag?"":data[i].otherflag,'                    </a>                    <dl>                        <dt class="name">',"undefined"==typeof data[i].name?"":data[i].name,'</dt>                        <dd class="rate">',"undefined"==typeof data[i].star?"":data[i].star,'</dd>                        <dd class="cmt">                            <span class="count">',"undefined"==typeof data[i].comment?"":data[i].comment,'</span>                            <span class="tail">条评论</span>                        </dd>                    </dl>                </li>            ');_template_fun_array.push("        </ul>    ")}_template_fun_array.push("")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={hasGetData:!1,firstShow:!1,init:function(a){this.page=a,this.bind()},bind:function(){switch(broadcaster.subscribe("nearpush.dataready",function(){this._render(helper.cates[id].data)},this),this.page){case"business":this._businessAction();break;case"index":this._indexAction();break;default:this._defaultAction()}},_defaultAction:function(){this._bindGeoEvent()},_businessAction:function(){this._fetch()},_indexAction:function(){helper.visible(".index-widget-cater",function(){this.hasGetData||(this._fetch(),this._bindGeoEvent())},this)},_bindGeoEvent:function(){broadcaster.subscribe("geolocation.success",this._fetch,this),broadcaster.subscribe("geolocation.fail",function(){},this)},_fetch:function(){var a=this,e=$(".index-widget-cater");$(".index-page-nearby-hd"),1!=locator.getCityCode()&&(e.css("min-height","160px"),util.showLoading(e)),helper.getData(id,function(){helper.ready()},{page:a.page}),this.hasGetData=!0},_render:function(a){var e=this,t=helper.cates[id].wd,i=$(".index-widget-cater"),d=$(".index-page-nearby-hd");a&&a.length>0?(i.html(tpl({data:a,id:id,word:t,page:e.page})),d.show(),e.firstShow||(stat.addStat(STAT_CODE.STAT_NEARPUSH_SHOW),e.firstShow=!0)):(i.css("min-height","0"),"index"==this.page&&d.hide()),util.hideLoading(i),this._bind()},_bind:function(){$(".index-widget-cater [jsaction]").on("click",this.jump)},jump:function(a){helper.go(a,id)}}});
;define("index:widget/nearpush/hotel.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),searchData=require("common:static/js/searchdata.js"),broadcaster=require("common:widget/broadcaster/broadcaster.js"),locator=require("common:widget/geolocation/location.js"),geolocator=require("common:widget/geolocation/geolocation.js"),helper=require("index:widget/helper/helper.js"),id="hotel",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <a href="javascript:void(0);" jsaction="hotel-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof word?"":word,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">            查看全部        </a>        <h2>酒店</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;l>i;i++){_template_fun_array.push("            ");var item=data[i];_template_fun_array.push('            <li jsaction="hotel-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof item.uid?"":item.uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <div class="clearfix">                    <a class="a-img" href="javascript:void(0);">                        <img width="89" height="66" src="',"undefined"==typeof item.image?"":item.image,'">                        ',"undefined"==typeof item.otherflag?"":item.otherflag,'                    </a>                    <dl>                        <dt class="name">',"undefined"==typeof item.name?"":item.name,'</dt>                        <dd class="addr">地址：',"undefined"==typeof item.addr?"":item.addr,'</dd>                        <dd class="cmt">                            <span class="rate">',"undefined"==typeof item.star?"":item.star,'</span>                            <span class="price">                                <span class="tail">人均：</span>                                <span class="count">￥',"undefined"==typeof item.price?"":item.price,'</span>                            </span>                        </dd>                    </dl>                </div>                <div class="bar clearfix">                        '),item.tel.num?_template_fun_array.push('                            <div class="btn tel">                                <a class="a-tel" ',"undefined"==typeof item.tel.url?"":item.tel.url,'>                                    <b class="icon tel"></b>',"undefined"==typeof item.tel.num?"":item.tel.num,"                                </a>                            </div>                            "):_template_fun_array.push('                            <div class="btn tel" style="visibility:hidden">                                <a class="a-tel" href="/">                                    <b class="icon tel"></b>000-00000000                                </a>                            </div>                              '),_template_fun_array.push("                    "),item.order&&_template_fun_array.push('                        <div class="btn order"><a href="javascript:void(0);" jsaction="hotel-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof item.uid?"":item.uid,'&#39;}">预订</a></div>                    '),_template_fun_array.push("                </div>            </li>        ")}_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={hasGetData:!1,init:function(e){this.page=e,this.bind()},bind:function(){switch(broadcaster.subscribe("nearpush.dataready",function(){this._render(helper.cates[id].data)},this),this.page){case"business":this._businessAction();break;case"index":this._indexAction();break;default:this._defaultAction()}},_defaultAction:function(){this._bindGeoEvent()},_businessAction:function(){this._fetch()},_indexAction:function(){helper.visible(".index-widget-hotel",function(){this.hasGetData||(this._fetch(),this._bindGeoEvent())},this)},_bindGeoEvent:function(){broadcaster.subscribe("geolocation.success",this._fetch,this),broadcaster.subscribe("geolocation.fail",function(){},this)},_fetch:function(){var e=this;this.hasGetData=!0,helper.getData(id,function(){helper.ready()},{page:e.page})},_render:function(e){var t=this,a=helper.cates[id].wd;e&&e.length>0&&$(".index-widget-hotel").html(tpl({data:e,id:id,word:a,page:t.page})),this._bind()},_bind:function(){$(".index-widget-hotel [jsaction]").on("click",this.jump),$(".index-widget-hotel .a-tel").on("click",function(e){var t=$(e.currentTarget),a=t.attr("data-tel");t&&a&&util.TelBox.showTb(a),e.stopPropagation()})},jump:function(e){helper.go(e,id)}}});
;define("index:widget/seacrhnave/searchboxmodel.js",function(t,e,i){var n=t("common:widget/geolocation/location.js"),a={data:{start:{word:""},end:{word:""},geo:{word:""}},init:function(){},value:function(t){return t&&$.isPlainObject(t)?this.set(this._deepAdaptive(t)):this.get()},_deepAdaptive:function(t){var e={};for(key in t)e[key]=this._adaptive(t[key]);return e},_adaptive:function(t){var e={};for(key in t)if("name"==key||"wd"==key?e.word=t[key]:"pt"==key?e.point=t[key]:e[key]=t[key],e.word==MY_GEO){if(n.hasExactPoi())return e;e=this.getExactlocationData()}return e.point&&$.isPlainObject(e.point)&&(e.point=e.point.lng+","+e.point.lat),e},set:function(t,e){t&&"string"==typeof t&&e&&$.isPlainObject(e)?this.data[t]=e:t&&$.isPlainObject(t)&&$.extend(this.data,t)},_set:function(t,e){t&&"string"==typeof t&&e&&$.isPlainObject(e)?this.data[t]=e:t&&$.isPlainObject(t)&&$.extend(this.data,t)},get:function(t){return t&&"string"==typeof t?this.data[t]:this.data},getExactlocationData:function(){var t={word:""},e=n;return e&&e.point&&(t={word:MY_GEO,point:e.point.x+","+e.point.y,citycode:e.addr.cityCode}),t},getCenterName:function(){return n.hasExactPoi()?n.isUserDeny()?n.getAddress():MY_GEO:""}};i.exports=a});
;define("index:widget/seacrhnave/seacrhnave.js",function(t,e,o){var s=(t("common:static/js/util.js"),t("common:widget/broadcaster/broadcaster.js")),r=t("common:widget/geolocation/location.js"),a=(t("common:widget/quickdelete/quickdelete.js"),t("common:widget/suggestion/suggestion.js"),t("common:widget/popup/popup.js")),i=t("common:widget/url/url.js").get(),n=t("common:widget/stat/stat.js"),d="我的位置",u=!1;o.exports={init:function(){this.render(),this.bind();var t=this._getPagetype();t.isSelf||(this[t.elSelf].val(t.word),this.model.set([t.el],{word:t.word,point:t.point}))},render:function(){var e=this;e.sestart=$("#se_txt_start"),e.seend=$("#se_txt_end"),e.maskid=$("#se_wrap"),e.reverseBtn=$("#se_dir_reverse"),e.model=t("index:widget/seacrhnave/searchboxmodel.js"),e.urlstart=e._proceedUrl(i.pageState.start),e.urlend=e._proceedUrl(i.pageState.end),e.pagetype=e._getPagetype(),e.selement=$("#se_txt_start, #se_txt_end"),e.submitbtn=$(".se-btn-tr"),e.sedirform=$(".se-dir-form")},_proceedUrl:function(t){var e=!1;return void 0!=t&&(e={word:"",point:""},datarr=t.trim().split("&"),datarr[0]&&(e.word=decodeURIComponent(datarr[0].split("=")[1])),datarr[1]&&(e.point=decodeURIComponent(datarr[1].split("=")[1]))),e},bind:function(){var t=this;$(window).on("pageshow",function(){u&&setTimeout(function(){t._setLocation()},0)}),t._poiQuickStart=$.ui.quickdelete({container:t.sestart}),t._poiSugStart=$.ui.suggestion({container:t.sestart,mask:t.maskid,source:"http://map.baidu.com/su",listCount:6,posAdapt:!1,isSharing:!0,offset:{x:0,y:144},param:$.param({type:"0",newmap:"1",ie:"utf-8"}),onsubmit:function(){t._poiSugStart&&t._poiSugStart.hide()},onfocus:function(){t._poiSugEnd&&t._poiSugEnd.hide()}}),t._poiQuickEnd=$.ui.quickdelete({container:t.seend}),t._poiSugEnd=$.ui.suggestion({container:t.seend,mask:t.maskid,source:"http://map.baidu.com/su",listCount:6,posAdapt:!1,isSharing:!0,offset:{x:0,y:144},param:$.param({type:"0",newmap:"1",ie:"utf-8"}),onsubmit:function(){t._poiSugEnd&&t._poiSugEnd.hide()},onfocus:function(){t._poiSugStart&&t._poiSugStart.hide()}}),t.reverseBtn.on("touchstart",$.proxy(t._reverse,this)),t.reverseBtn.on("touchend",$.proxy(t._reverseEnd,this)),s.subscribe("geolocation.mylocsuc",function(){var t=this;u=!!r.getMyLocation().point,t._setLocation()},this),t.selement.on("focus",$.proxy(t._focus,this)),t.selement.on("blur",$.proxy(t._blur,this)),t.selement.on("mousedown",$.proxy(t._touchstart,this)),t.submitbtn.on("touchstart",$.proxy(t._poiSubmit,this)),t.submitbtn.on("touchend",$.proxy(t._poiSubmitEnd,this)),t.selement.on("mousedown",$.proxy(t._touchstart,this)),t.sedirform.on("submit",$.proxy(this._poiSubmit,this))},_getPagetype:function(){var t=this;return result={elSelf:"",el:"sestart",key:"start",isSelf:!1,word:"",point:""},t.urlend?(result.elSelf="seend",result.word=t.urlend.word,result.point=t.urlend.point):t.urlstart?(result.key="end",result.el="seend",result.elSelf="sestart",result.word=t.urlstart.word,result.point=t.urlend.point):result.isSelf=!0,result},_checkInput:function(t){return t?/\S+/.test(t.val())?t.val()==d&&this.model.get("geo").word!=d?(t.val(""),a.open({text:"定位失败！"}),!1):!0:(t.focus(),!1):!1},_getGeoData:function(){var t={word:"",point:"",citycode:""};return r.getLocation(),u&&(t={word:d,point:r.getMyPointX()+","+r.getMyPointY(),citycode:r.getMyCityCode()}),t},_reverse:function(){var t=this,e={start:$("#se_txt_start").val(),end:$("#se_txt_end").val()};t.reverseBtn.addClass("active"),t.sestart.val(e.end),t.seend.val(e.start),t.model.set("end",{word:e.start}),t.model.set("start",{word:e.end}),t._update()},_reverseEnd:function(){this.reverseBtn.removeClass("active")},_update:function(){var t=this,e=t.sestart,o=t.seend,s=t.model.get("geo");e.val()==d&&s.word==d&&u?(e.addClass("geo"),o.removeClass("geo")):e.removeClass("geo"),o.val()==d&&s.word==d&&u?(o.addClass("geo"),e.removeClass("geo")):o.removeClass("geo")},_setLocation:function(){var t=this;t.sestart,t.seend,result=t.pagetype,geoData=t._getGeoData(),u&&t[result.el].val(d),result.key&&t.model.set(result.key,geoData);var e=t.model.get("geo");(!e.point||geoData&&""!==geoData.point)&&t.model.set("geo",geoData),t._update()},_focus:function(t){var e=$(t.target),o=$(".se-inner");e.hasClass("se_txt_start")&&(o[0].style.border="1px solid #D55959",o[1].style.border="1px solid #d9d9d9"),e.hasClass("se_txt_end")&&(o[0].style.border="1px solid #d9d9d9",o[1].style.border="1px solid #D55959"),e.val()==d&&e.val(""),e.removeClass("geo")},_blur:function(t){var e=this,o=$(t.target),s=o.attr("key"),r=e.model.get("geo"),i=r.word!=d&&n==d&&u,n=o.val().trim();if(i&&(o.val(""),a.open({text:"定位失败！"})),r.point&&""==n&&u){e.model.get(s).word==r.word&&(o.val(d),o.addClass("geo"));var l="start"==s?"start":"end";e["se"+l].val()!=d&&(e.model.set(s,e._getGeoData()),e.model.set(l,{word:""}))}},_fixDirData:function(){var t=$(".se-dir-form input[type=text]"),e=this._getPagetype();ptIsSelf=e.isSelf,me=this,$.each(t,function(){var t=$(this).attr("key"),o=$("#se_txt_"+t),s=me.model.get(t),r=s.word!=o.val();(!s.word||r)&&(o.val()===d&&u?me.model.set(t,me._getGeoData()):ptIsSelf||o.val()!=e.word?me.model.set(t,{word:o.val()}):me.model.set(t,{word:e.word,point:e.point}))})},_touchstart:function(t){var e=$(t.target);e.focus(),t.stopPropagation()},_getDirParam:function(t,e,o,s){var a,i=r.getCityCode()||1,n=this._getTabIndex("search",t),d=e.citycode||i,u=o.citycode||i,l=d||i;if(e.point&&o.point||!e.point&&!o.point)a={qt:["s","bt","nav","walk"][n]||"bt",sn:this._joinParam(e),en:this._joinParam(o),sc:d,ec:u,c:l,pn:"0",rn:"5"};else{var p,c,m,g;e.point?(p=e,g=o,c="sn",m="1"):(p=o,g=e,c="en",m="0");var _=["s","bse","nse","wse"][n]||"bse",v=p.point;a={qt:_,ptx:v.split(",")[0],pty:v.split(",")[1],wd:g.word||"",name:p.word||"",c:i,sc:e.citycode||i,ec:o.citycode||i,isSingle:"true"},a[_+"tp"]=m,a[c]=this._joinParam(p)}return s&&s.from&&(a.searchFlag=s.from||""),["nav","nse","walk","wse"].indexOf(a.qt)>=0&&(a.version="3"),["bse","bt"].indexOf(a.qt)>=0&&(a.version="5",a.exptype="dep"),a},_poiSubmit:function(t){t&&t.stopPropagation&&t.stopPropagation(),t&&t.preventDefault&&t.preventDefault();var e,o=t;o.target&&(e=$(t.target).attr("data-value"));var s=$(o.target);s.addClass("active"),e||(e=1);var r=this,a=r.sestart,i=r.seend;if(!r._checkInput(a)||!r._checkInput(i))return!1;switch(this._fixDirData(),e){case"1":n.addCookieStat(STAT_CODE.STAT_BUS_SEARCH);break;case"2":n.addCookieStat(STAT_CODE.STAT_NAV_SEARCH);break;case"3":n.addCookieStat(STAT_CODE.STAT_WALK_SEARCH)}PDC&&PDC._setWtCookie();var d=r._getDirParam(e,this.model.get("start"),this.model.get("end"),t);location.href="/mobile/webapp/search/search/"+$.param(d)},_poiSubmitEnd:function(t){var e=t,o=$(e.target);o.removeClass("active")},_getTabIndex:function(t,e){if(!isNaN(e)){var o=this._num2str(t,e),s=this._str2num(t,o);return s}return"string"==typeof e?this._str2num(t,e):void 0},_getTabStr:function(t,e){if(!isNaN(e))return this._num2str(t,e);if(_.isString(e)){var o=this._str2num(t,e),s=this._num2str(t,o);return s}},_num2str:function(t,e){return"tab"==t?["place","line"][e]||"place":["place","transit","drive","walk"][e]||"place"},_str2num:function(t,e){return"tab"==t?{plcae:0,line:1}[e]||0:{place:0,transit:1,drive:2,walk:3}[e]||0},_joinParam:function(t){if(!t)return"";var e=t.point?"1":"2",o=t.uid||"",s=t.point||"",r=t.word||"";return[e,o,s,r,""].join("$$")}}});
;define("index:widget/searchbox/searchbox.js",function(t,i,o){var e=(t("common:static/js/util.js"),t("common:widget/url/url.js")),n=t("common:widget/broadcaster/broadcaster.js"),s=(t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),a=(t("common:widget/quickdelete/quickdelete.js"),t("common:widget/suggestion/suggestion.js"),t("common:widget/search/poisearch.js")),c=t("common:widget/stat/stat.js"),r=t("common:widget/apphistory/apphistory.js");o.exports={init:function(){this.render(),this.bind()},render:function(){var t=this;window.localStorage&&window.localStorage.input&&(r.isLanding()?localStorage.removeItem("input"):$("#se-input-poi").val(localStorage.input)),this._poiQuick=$.ui.quickdelete({container:".se-input-poi",offset:{x:0,y:2}}),this._poiSug=$.ui.suggestion({container:".se-input-poi",mask:".se-form",source:"http://map.baidu.com/su",listCount:6,posAdapt:!1,isSharing:!0,offset:{x:0,y:52},param:$.param({type:"0",newmap:"1",ie:"utf-8"}),onsubmit:function(){var i=this.getValue();$(".se-input-poi").val(i),i&&t.submit()}})},bind:function(){$(".se-form").on("submit",$.proxy(this.submit,this)),$(".se-btn").on("click",$.proxy(this.submit,this)),$(".se-input-poi").on("blur",function(){$(".se-city").show()}),$(".se-input-poi").on("focus",function(){$(".se-city").hide()}),n.subscribe("geolocation.success",this.updateMyPos,this),$(".index-widget-searchbox [jsaction]").on("click",$.proxy(this.go,this))},go:function(t){var i=$(t.currentTarget);switch(i.attr("jsaction")){case"toNavSearch":var o={qt:"cur",wd:s.getCity()||"全国",from:"maponline",tn:"m01","ie=utf-8":"utf-8"};window.localStorage&&(localStorage.input=$("#se-input-poi").val()),e.update({query:o,pageState:{tab:"line"}},{queryReplace:!0})}return!1},submit:function(t){var i=$(".se-input-poi");if(!this._checkInput(i))return!1;if(t){var o=$(t.currentTarget),e=o.attr("user-data");"se-btn"==e&&this._poiSug&&this._poiSug._localStorage(i.val())}return i.blur(),c.addCookieStat(STAT_CODE.STAT_POI_SEARCH),a.search(i.val()),!1},updateMyPos:function(t){t=t?t:s.getLocation(),t.addr&&t.addr.city&&$(".se-city-wd").text(t.addr.city)},_checkInput:function(t){return t?/\S+/.test(t.val())?!0:(t.focus(),!1):!1}}});
;define("index:widget/surface/surface.js",function(o,t,e){o("common:static/js/util.js"),o("common:widget/url/url.js"),o("common:widget/broadcaster/broadcaster.js"),o("common:widget/geolocation/geolocation.js"),o("common:widget/geolocation/location.js"),o("common:widget/quickdelete/quickdelete.js"),o("common:widget/suggestion/suggestion.js"),o("common:widget/search/poisearch.js"),o("common:widget/stat/stat.js"),e.exports={init:function(){this.bind()},bind:function(){$(".close").on("click",function(){$(".return-wap").hide(),$(".common-widget-back-top").css("bottom","0")})}}});
;define("index:widget/sventry/sventry.js",function(require,exports,module){var util=require("common:static/js/util.js");module.exports.init=function(){bind()};var bind=function(){$(".index-widget-sventry .city-item").on("click",function(){_onClickCity($(this))})},_onClickCity=function(elem){var dataStr=elem.attr("data");eval("var dataObj = "+dataStr),elem.attr("href",_getSvUrl(dataObj))},_getSvUrl=function(t){var e="/mobile/webapp/index/streetview/ss_id=";return window.egg=t,e+=t.sid+"&ss_heading="+t.heading+"&ss_pitch="+t.pitch}});
;define("index:widget/thumbnail/userheading.js",function(t,i,n){function e(){this._timeStamp=0,this._doms=[],this._alpha=0,this._orientation=window.orientation}e.prototype.start=function(t){var i=this;i._doms.push(t),i._started||(i._started=!0,window.addEventListener("deviceorientation",function(t){var n;if(n=t.webkitCompassHeading?Math.round(0-t.webkitCompassHeading):Math.round(t.alpha),n-=i._orientation,!(t.timeStamp-i._timeStamp<100)){i._timeStamp=t.timeStamp;var e=Math.abs(i._alpha-n);if(e>5){for(var o=0;o<i._doms.length;o++)i._doms[o]&&i._doms[o].style&&(i._doms[o].style.transform=i._doms[o].style.webkitTransform="rotate("+Math.round(0-n)+"deg)");i._alpha=n}}},!0),window.addEventListener("orientationchange",function(){i._orientation=window.orientation},!0))},e.prototype.isSupport=function(){var t=navigator.userAgent;return t.indexOf("Android")>-1||!window.DeviceOrientationEvent?!1:!0},n.exports=new e});
;define("index:widget/thumbnail/thumbnail.js",function(t,i,e){var s=t("common:widget/broadcaster/broadcaster.js"),n=t("common:static/js/util.js"),o=(t("common:widget/url/url.js"),t("common:widget/popup/popup.js")),a=t("common:widget/geolocation/location.js");stat=t("common:widget/stat/stat.js");var r={type:0,level:16,height:101,width:window.innerWidth-22,url:null,host:"http://snap.map.baidu.com/?qt=snap&data="};e.exports={flag:{appreszie:!1,wait:void 0},state:"start",init:function(){this.prevPoint=void 0,this.render(),this.bind()},render:function(){this.thumbImg=$(".thumb-img"),this.thumbWrap=$(".thumb-wrap"),this.locbarTxt=$(".locbar-txt"),this.centerMarker=$(".center-marker"),this.geoBtn=$(".thumb-left"),this.inBtn=$(".in-btn"),this.errorCnt=$(".error-cnt"),this.thumbLink=$(".thumb-link"),this.setState("start"),this.setUserHeading()},bind:function(){var t=this;t.geoBtn.on("click",function(i){stat.addStat(STAT_CODE.STAT_THUNB_START_GEO),t.startGeo(),i.stopImmediatePropagation(),i.stopPropagation()}),t.thumbImg.on("load",function(){t.errorCnt.hide(),t.thumbImg.show(),t.geoBtn.show(),t.hideLoading()}),t.thumbImg.on("error",function(){t.errorCnt.show(),t.thumbImg.hide(),t.centerMarker.hide(),t.hideLoading()}),s.subscribe("geolocation.success",function(){this.successCBK()},this),s.subscribe("geolocation.fail",function(){this.failCBK()},this)},successCBK:function(){this.flag.appreszie||(s.subscribe("sizechange",function(){this._appReSize()},this),this.flag.appreszie=!0),this.setState("success")},failCBK:function(){this.setState("fail")},setState:function(t){switch(this.flag.state=t,this.addStateToLog(t),t){case"start":this.state="start",this.showLoading(),this.waitForLoc(8);break;case"success":this.state="success",this.hideLoading(),this.setLocation();break;case"fail":this.state="fail",this.hideLoading(),this.centerMarker.hide(),o.open({text:"定位失败"}),this.setLocation(),this.flag.wait&&window.clearTimeout(this.flag.wait)}},addStateToLog:function(t){if("success"===t||"fail"===t){var i={code:STAT_CODE.STAT_THUMB_IMG_CLICK,state:t};this.thumbLink.data("log",JSON.stringify(i))}},startGeo:function(){this.setState("start"),a.startGeo()},waitForLoc:function(t){var i=this;i.flag.wait&&window.clearTimeout(i.flag.wait),i.flag.wait=window.setTimeout(function(){"success"!=i.state&&i.failCBK()},1e3*t)},setUserHeading:function(){var i=t("index:widget/thumbnail/userheading.js");if(i.isSupport()){this.centerMarker.addClass("navi-marker");var e=$(".center-marker div").get(0);i.start(e)}},setLocation:function(){var t=a.getCenterPoi();this._unEqualPoint(t)?(this.prevPoint=t,this._setThumbUrl()):void 0!=this.prevPoint&&this.hideLoading(),this._setLocBarAddress(),this._setGeoBtnStatus(),this._setSearchBoxCity()},showLoading:function(){n.showLoading(this.thumbWrap),this.locbarTxt.html("正在定位您的位置...")},hideLoading:function(){n.hideLoading(this.thumbWrap)},_setLocBarAddress:function(t){var i=t||a.getAddress();this.locbarTxt.html(i)},_setSearchBoxCity:function(t){var t=t||a.getCity();$(".se-city-wd").html(t)},_setGeoBtnStatus:function(){a.hasExactPoi()?this.geoBtn.removeClass("geo-fail"):this.geoBtn.addClass("geo-fail")},_setThumbUrl:function(t){var i=this,e=t||i._getThumbUrl();a.hasExactPoi()?i.centerMarker.show():i.centerMarker.hide(),i.thumbImg.attr("src",e)},_appReSize:function(){var t=this;n.isAndroid()?setTimeout(function(){r.width=window.innerWidth-22},800):r.width=window.innerWidth-22,t._setThumbUrl()},_equalPoint:function(t){return this.prevPoint&&this.prevPoint.x==t.x&&this.prevPoint.y==t.y},_unEqualPoint:function(t){return void 0==this.prevPoint||t.x!=this.prevPoint.x||t.y!=this.prevPoint.y},_getThumbUrl:function(t){r.level=0==r.type?"全国"==a.getCity()?3:a.hasExactPoi()?16:10:10,void 0==t&&(t=a.getCenterPoi());var i={retype:1,src:"webapp",level:r.level,center:t.x+" "+t.y,height:101,width:r.width,coordtype:"M",pictype:r.type};return r.host+JSON.stringify(i)}}});
;define("index:widget/waitforloc/waitforloc.js",function(e,t,n){var i=e("common:widget/geolocation/geolocation.js"),a=e("common:widget/broadcaster/broadcaster.js"),r=e("common:widget/url/url.js"),o=e("common:widget/geolocation/location.js");n.exports={config:{lineQtMap:{bt:"bse"},qtMap:{place:"s|con|nb|bd",transit:"bt|bse",drive:"nav|nse",walk:"walk|wse"}},init:function(){this.initIpGeo(),this.bindEvent(),this.initGeo()},initIpGeo:function(){try{var e=window.localStorage;window._DEFAULT_CITY.index?(e.setItem("_DEFAULT_CITY",JSON.stringify(window._DEFAULT_CITY)),cookie.set("DEFAULT_CITY","1",{expires:3e5,domain:"baidu.com",path:"/"})):window._DEFAULT_CITY=JSON.parse(e.getItem("_DEFAULT_CITY"))||{}}catch(t){}var n,i,a,r,s;n=JSON.parse(_DEFAULT_CITY.index)||{},i=n&&n.content,a=i&&i.geo,s=i.level,r=a.split(";")[1].split("|")[0].split(","),1==i.code&&(i.name="全国"),locationData={addr:{city:i.cname,cityCode:i.code},point:{x:r[0],y:r[1]},level:s,type:"ip",isExactPoi:!1,isGeoEnd:!1},o.setAddress(locationData)},bindEvent:function(){var e=this;a.subscribe("geolocation.success",function(){e.geoSuccess()}),a.subscribe("geolocation.fail",function(){e.geoFail()})},initGeo:function(){var e=this;i.init(),setTimeout(function(){e.geoFail()},8e3)},geoSuccess:function(){var e=r.get();this._initMixLocOptionsPage(e)},geoFail:function(){var e=r.get();this.locErrorCallback(e)},_initMixLocOptionsPage:function(e){var t=this,n=e.pageState&&e.pageState.needloc;e.query,n&&"1"===n?t._initPlacePage(e):t._initTransitPage(e)},_initTransitPage:function(e){var t="我的位置",n=e.query||{},i=n.sn||"",a=n.en||"";geoQuery=n,key="sn",snArr=""+i.split("$$")[3],enArr=""+a.split("$$")[3],q="1$$$$"+o.getPointX()+","+o.getPointY()+"$$我的位置$$",wd=geoQuery.wd?geoQuery.wd:snArr!=t?snArr:enArr,snArr===t||enArr===t?enArr===t&&(key="en"):key=""===$.trim(snArr)?"sn":"en",geoQuery[key]=q,geoQuery=$.extend(geoQuery,{ptx:o.getPointX(),pty:o.getPointY(),bsetp:1,ec:o.getCityCode(),sc:o.getCityCode(),isSingle:"true",name:t,wd:wd}),geoQuery.qt=this.config.lineQtMap[geoQuery.qt]||geoQuery.qt,r.update({module:"search",action:"search",query:geoQuery,pageState:{has_handle_geo:1,needloc:""}},{trigger:!0,replace:!0})},getSearchTypeConfig:function(){var e=this.config.qtMap,t={};return $.each(e,function(e,n){_qt=n.split("|"),$.each(_qt,function(n,i){t[i]=e})}),t},_initPlacePage:function(e){var t=this,n={center_rank:1,nb_x:o.getPointX(),nb_y:o.getPointY(),c:o.getCityCode()};t._getOptions(e,n),r.update({module:"search",action:"search",query:{center_rank:n.center_rank,nb_x:n.nb_x,nb_y:n.nb_y,c:n.c},pageState:{center_name:"我的位置",has_handle_geo:1,needloc:""}},{replace:!0})},_getOptions:function(e,t){for(var n in t)e.query[n]=t[n];return e},_initPage:function(){this._searchData()},locErrorCallback:function(e){var t=this.getSearchType(e);switch(t){case"place":this._initPage(e);break;case"walk":case"transit":case"drive":this.setSearchBoxValue(e);default:this._switchToIndex(e)}},getSearchType:function(e){if(e){var t=e.query||{},n=t.qt,i=this.searchTypeConfig||this.getSearchTypeConfig();return this.searchTypeConfig=i,i[n]}},setSearchBoxValue:function(e){var t=this._getStartAndEndWord(e)||{},n="我的位置";t.start&&t.start!=n&&(this.start="word="+encodeURIComponent(t.start)),t.end&&t.end!=n&&(this.end="word="+encodeURIComponent(t.end))},_getUrl:function(){var e=r.get().query||{};return this.isLanding&&(third_party=location.href.match(/[\?\&]third_party=([^&^#]+)/),third_party&&(e.searchFlag=third_party[1]||"","baidukuangpush"===third_party[1]&&(e.tg="push"))),e.c||(e.c=o.getCityCode()),["nav","nse","walk","wse"].indexOf(e.qt)>=0&&(e.version="3"),("nav"==e.qt||"bt"==e.qt)&&(e.wd1&&!e.sn&&(e.sn="2$$$$$$"+e.wd1+"$$"),e.wd2&&!e.en&&(e.en="2$$$$$$"+e.wd2+"$$")),e},_searchData:function(){var e=this._getUrl();r.update({module:"search",action:"search",query:e,pageState:{needloc:""}},{replace:!0,queryReplace:!0})},_switchToIndex:function(e){var t=this.getSearchType(e),n=e.pagestate||{},i=e.query||{},a="";n.tab=t,("walk"===n.tab||"drive"===n.tab||"transit"===n.tab)&&(a="line");var o={};this.start&&(o.start=this.start),this.end&&(o.end=this.end),o.tab=a,r.update({module:"index",action:"index",query:i,pageState:o},{trigger:!0,replace:!0,queryReplace:!0,pageStateReplace:!0})},_getStartAndEndWord:function(e){if(e&&e.query){var t=e.query,n=t.sn||"",i=t.en||"",a=n.split("$$")[3]||t.name||"",r=i.split("$$")[3]||t.wd||"";return{start:a,end:r}}}}});