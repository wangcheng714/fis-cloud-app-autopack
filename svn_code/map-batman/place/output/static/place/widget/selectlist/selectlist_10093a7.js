define("place:widget/selectlist/selectlist.js",function(e,t,n){var i=e("common:widget/geolocation/location.js"),o=e("common:widget/url/url.js"),a=e("common:static/js/util.js"),c=e("common:widget/setcity/setcity.js"),r="_refer_query",d="_refer_pagestate";n.exports.init=function(e){p(e),s()};var l,u="http://"+location.host+"/mobile/webapp/index/index",y="     ",p=function(e){l=e},s=function(){$list=$(".place-widget-selectlist"),$list.on("click","li",m)},m=function(){var e=$(this),t=+e.data("i")-1;g(t)},g=function(e){if("undefined"!=typeof e){var t=l.list[e],n=o.get(),i=n.pageState,a=_(t),u=i.refer_pagestate||window.localStorage.getItem(d),y=i.refer_query||window.localStorage.getItem(r);y&&"undefined"!=y?(w(a,!1),f(t,{referQuery:y,referPageState:u})):(w(a),a.isExactPoi||3===a.addr.cityType?v():c.setAndRedirect(a.addr.city,a.addr.cityCode))}},f=function(e,t){var n,i,c=o.get(),u=t||{},p=(c.pageState||{},a.urlToJSON(u.referQuery)||{}),s=a.urlToJSON(u.referPageState)||{},m="wm"===p.qt||"takeout"===s.search,g=l.city;window.localStorage.removeItem(r),window.localStorage.removeItem(d),p.wd&&p.wd.split(y)[1]&&(p.wd=p.wd.split(y)[1]),p.c=g.code,i=S(),n=m?b(e,p):h(e,p),s=$.extend(s,{center_name:e.name||""}),delete s.i,o.update({module:n.module,action:n.action,query:n.query,pageState:s},{queryReplace:!0,pageStateReplace:!0})},_=function(e){if(e){S(),l.city;var t,n=a.geoToPoint(e.geo),i=x(e);return t={addr:i,isExactPoi:i.isExactPoi,point:{x:n.lng,y:n.lat}}}},w=function(e){e&&(e.isSaveLocInCookie=!0,i.setAddress(e))},x=function(e){var t,n,i=l.city;cityName=i.name,e.cname?(name=e.pcname?e.pcname+e.cname:e.cname,n=!1):(name=e.name,n=!0);var o=null;return 3===e.city_type&&(o=i.up_cityid),t={address:name,city:cityName,cityCode:e.code?e.code:i.code,isExactPoi:n,cityType:e.city_type?e.city_type:i.type,upCityCode:e.pccode?e.pccode:o}},S=function(){return l.type},v=function(){window.location.href=u},b=function(e,t){var n,i=S();return 2!=i?(n=a.geoToPoint(e.geo),t.pointX1=n.lng,t.pointY1=n.lat,t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1,t.m="searchXY"):(t.m="searchBrands",delete t.pointX1,delete t.pointY1,delete t.center_rank,delete t.nb_x,delete t.nb_y),t=$.extend(t,{cityId:e.addr.cityCode,directId:e.addr.cityCode,pageNum:1,pageSize:10}),{query:t,module:"place",action:"takeout"}},h=function(e,t){var n,i=S();return 2!=i?(n=a.geoToPoint(e.geo),t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1):(delete t.nb_x,delete t.nb_y,delete t.center_rank,delete t.pointX1,delete t.pointY1),t=$.extend(t,{c:e.addr.cityCode,center_rank:1,pn:0}),{query:t,module:"search",action:"search"}}});