define("place:widget/selectbox/selectbox.js",function(e,t,a){var r,_,s,o=e("common:widget/url/url.js"),n=e("common:widget/geolocation/location.js"),c=e("common:static/js/util.js"),l=e("common:widget/stat/stat.js"),i=$(".place-widget-selectbox select"),p=($(".place-widget-selectbox select"),{takeout:{pl_dist:"radius",pl_sort_type:"sortType",pl_sort_rule:"orderType",pn:"pageNum"}});a.exports.init=function(e){var t,a;(s=e||{})&&(t=s.wd)&&(a=s.srcname),d(),r=s.select_type,_=s.what,l.addStat(STAT_CODE.PLACE_LIST_FILTER_VIEW,{wd:t,srcname:a})};var d=function(){i.length,$.each(i,function(e,t){$(t).on("change",u)}),$(".city-select").on("click",m)},u=function(e){var t=e.target,a=$(t).closest("select").attr("name"),r=$(t)[0].selectedIndex,_=$($(t)[0][r]),o=_.text(),n=s.wd,c=s.srcname;switch(a){case"pl_dist":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_RANGE_CLICK,{wd:n,range:o,srcname:c});break;case"pl_sort_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_SORT_CLICK,{wd:n,sort:o,srcname:c});break;case"pl_sub_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_CATEGORY_CLICK,{wd:n,type:o,srcname:c})}C(t),y()},C=function(e){var t=$(e),a=t[0].selectedIndex,r=$(t[0][a]),_=r.text(),s=t.parent().children(".select_title");s.html(_)},y=function(){var e=o.get().query,t=g(),a=n.getCityCode();t=$.extend(t,{pn:0}),e=$.extend(e,t,{c:a}),"takeout"===r&&(e=T(e,r)),e.pl_tonight_sale_flag_section&&delete e.pl_tonight_sale_flag_section,"全市"==e.pl_dist?delete e.center_rank:e.nb_x&&e.nb_y&&(e.center_rank=1),e.pl_movie_book_section="movie_book"==e.pl_sort_type?"1,1":"0,+",o.update({query:e,pageState:{show_select:1}},{queryReplace:!0,replace:!0})},g=function(){var e,t,a={};return $.each(i,function(r,_){var s={},o=$(_);switch(o.parent("select-box"),e=$(_).attr("name"),t=$(_).val(),e){case"pl_sub_type":s.wd=t,s.pl_sub_type=t;break;case"pl_sort_type":s.pl_sort_type=t.split("__")[0],s.pl_sort_rule=t.split("__")[1]||0;break;case"pl_dist":s.pl_dist=t}a=$.extend(a,s)}),a},T=function(e,t){if(e&&t){var a=$.extend({},e),r=p[t];return $.each(r,function(e,t){var r=a[e];r&&(a[t]=r),"pl_sort_rule"!==e&&"0"==r&&delete a[t],delete a[e]}),a}},m=function(){var e=n.getCityType(),t=n.getCityCode(),a=o.get(),r=a.query||{},i=(a.pageState||{},s.wd),p=s.srcname;r.wd=_||r.wd,3===e&&(t=n.getUpCityCode()||t),refer_query=c.jsonToUrl(a.query||{}),refer_pagestate=c.jsonToUrl(a.pageState||{}),l.addCookieStat(STAT_CODE.PLACE_SELECT_CLICK_CITY,{wd:i,srcname:p}),o.update({module:"index",action:"setmylocation",query:{c:t},pageState:{refer_query:refer_query,refer_pagestate:refer_pagestate,list_type:"business_area"}},{queryReplace:!0,pageStateReplace:!0})}});